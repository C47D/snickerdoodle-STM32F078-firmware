\hypertarget{group___s_d___button___functions}{}\section{Button Functions}
\label{group___s_d___button___functions}\index{Button Functions@{Button Functions}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{group___s_d___button___types_ga93131f1a3e8fe4f740d62e8ac62685e8}{sd\+\_\+button\+\_\+err}} \mbox{\hyperlink{group___s_d___button___functions_gafbd98b246aac98e61d371b0317da9556}{sd\+\_\+button\+\_\+init}} (struct \mbox{\hyperlink{structsd__button}{sd\+\_\+button}} $\ast$butt, G\+P\+I\+O\+\_\+\+Type\+Def $\ast$port, uint16\+\_\+t pin, uint32\+\_\+t up\+\_\+to, void($\ast$up\+\_\+cb)(void), uint32\+\_\+t down\+\_\+to, void($\ast$down\+\_\+cb)(void))
\begin{DoxyCompactList}\small\item\em Initialize Button Port/\+Pin and State Machine. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{group___s_d___button___types_ga93131f1a3e8fe4f740d62e8ac62685e8}{sd\+\_\+button\+\_\+err}} \mbox{\hyperlink{group___s_d___button___functions_ga7a7531af5b22def563a84f74d8328aa8}{sd\+\_\+button\+\_\+run}} (struct \mbox{\hyperlink{structsd__button}{sd\+\_\+button}} $\ast$butt)
\begin{DoxyCompactList}\small\item\em Run Button State Machine. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Function Documentation}
\mbox{\Hypertarget{group___s_d___button___functions_gafbd98b246aac98e61d371b0317da9556}\label{group___s_d___button___functions_gafbd98b246aac98e61d371b0317da9556}} 
\index{Button Functions@{Button Functions}!sd\+\_\+button\+\_\+init@{sd\+\_\+button\+\_\+init}}
\index{sd\+\_\+button\+\_\+init@{sd\+\_\+button\+\_\+init}!Button Functions@{Button Functions}}
\subsubsection{\texorpdfstring{sd\+\_\+button\+\_\+init()}{sd\_button\_init()}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{group___s_d___button___types_ga93131f1a3e8fe4f740d62e8ac62685e8}{sd\+\_\+button\+\_\+err}} sd\+\_\+button\+\_\+init (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structsd__button}{sd\+\_\+button}} $\ast$}]{butt,  }\item[{G\+P\+I\+O\+\_\+\+Type\+Def $\ast$}]{port,  }\item[{uint16\+\_\+t}]{pin,  }\item[{uint32\+\_\+t}]{up\+\_\+to,  }\item[{void($\ast$)(void)}]{up\+\_\+cb,  }\item[{uint32\+\_\+t}]{down\+\_\+to,  }\item[{void($\ast$)(void)}]{down\+\_\+cb }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\mbox{\hyperlink{sd__button_8c}{Src/sd\+\_\+button.\+c}}$>$}



Initialize Button Port/\+Pin and State Machine. 


\begin{DoxyParams}{Parameters}
{\em butt} & Button to initialize \\
\hline
{\em port} & G\+P\+IO port of button \\
\hline
{\em pin} & G\+P\+IO pin of button \\
\hline
{\em up\+\_\+to} & Button up debounce timeout \\
\hline
{\em up\+\_\+cb} & Button up callback function \\
\hline
{\em down\+\_\+to} & Button down debounce timeout \\
\hline
{\em down\+\_\+cb} & Button down callback function \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em S\+D\+\_\+\+B\+U\+T\+T\+O\+N\+\_\+\+S\+U\+C\+C\+E\+SS} & on success, error code otherwise \\
\hline
\end{DoxyRetVals}

\begin{DoxyCode}
98 \{
99     butt->\mbox{\hyperlink{structsd__button_a82241972e0292c7de95ea1e293e11be3}{port}} = port;
100     butt->\mbox{\hyperlink{structsd__button_a4144813adfa4dfe7e7cbeea17d1b06eb}{pin}} = pin;
101     butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}} = \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cacc42f7640a397b5daf63328ab9ae0d88}{SD\_BUTTON\_IDLE}};
102     
103     butt->\mbox{\hyperlink{structsd__button_a92e85c4fc2f84cfa9fbed1fd60a7fac7}{up\_to}} = up\_to;
104     butt->\mbox{\hyperlink{structsd__button_afc4472a8d74ec3156eae7b77bf8a256c}{up\_cb}} = up\_cb;
105     
106     butt->\mbox{\hyperlink{structsd__button_a3a9f2a46d68b7d2da0fafa3f2ddbdfb1}{down\_to}} = down\_to;
107     butt->\mbox{\hyperlink{structsd__button_ab831af9861aafa479d1245fb2a3633fc}{down\_cb}} = down\_cb;
108     
109     \textcolor{keywordflow}{return} \mbox{\hyperlink{group___s_d___button___types_gga93131f1a3e8fe4f740d62e8ac62685e8a4dfca3cbf0aed46511901c12ac832585}{SD\_BUTTON\_SUCCESS}};
110 \}
\end{DoxyCode}
\mbox{\Hypertarget{group___s_d___button___functions_ga7a7531af5b22def563a84f74d8328aa8}\label{group___s_d___button___functions_ga7a7531af5b22def563a84f74d8328aa8}} 
\index{Button Functions@{Button Functions}!sd\+\_\+button\+\_\+run@{sd\+\_\+button\+\_\+run}}
\index{sd\+\_\+button\+\_\+run@{sd\+\_\+button\+\_\+run}!Button Functions@{Button Functions}}
\subsubsection{\texorpdfstring{sd\+\_\+button\+\_\+run()}{sd\_button\_run()}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{group___s_d___button___types_ga93131f1a3e8fe4f740d62e8ac62685e8}{sd\+\_\+button\+\_\+err}} sd\+\_\+button\+\_\+run (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structsd__button}{sd\+\_\+button}} $\ast$}]{butt }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\mbox{\hyperlink{sd__button_8c}{Src/sd\+\_\+button.\+c}}$>$}



Run Button State Machine. 


\begin{DoxyParams}{Parameters}
{\em butt} & Button to run state machine \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em S\+D\+\_\+\+B\+U\+T\+T\+O\+N\+\_\+\+S\+U\+C\+C\+E\+SS} & on success, error code otherwise \\
\hline
\end{DoxyRetVals}

\begin{DoxyCode}
120 \{
121     \textcolor{keywordflow}{switch} (butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}}) \{
122     \textcolor{keywordflow}{case} \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cacc42f7640a397b5daf63328ab9ae0d88}{SD\_BUTTON\_IDLE}}:  
123         \textcolor{keywordflow}{if} (butt->\mbox{\hyperlink{structsd__button_a82241972e0292c7de95ea1e293e11be3}{port}}->IDR & butt->\mbox{\hyperlink{structsd__button_a4144813adfa4dfe7e7cbeea17d1b06eb}{pin}}) \{
124             \textcolor{comment}{/* The button is not pressed */}
125         \} \textcolor{keywordflow}{else} \{
126             \textcolor{comment}{/* Record the timer value before transitioning */}
127             butt->\mbox{\hyperlink{structsd__button_a260e06ce96c2e4deebccaedeb059dc0b}{tick}} = HAL\_GetTick();
128             butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}} = \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cafbe7ffa1bfcd9e4b225bcceec360042d}{SD\_BUTTON\_DOWN\_WAIT}};  
129         \}
130         \textcolor{keywordflow}{break};
131     
132     \textcolor{keywordflow}{case} \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cafbe7ffa1bfcd9e4b225bcceec360042d}{SD\_BUTTON\_DOWN\_WAIT}}:
133         \textcolor{keywordflow}{if} (butt->\mbox{\hyperlink{structsd__button_a82241972e0292c7de95ea1e293e11be3}{port}}->IDR & butt->\mbox{\hyperlink{structsd__button_a4144813adfa4dfe7e7cbeea17d1b06eb}{pin}}) \{
134             \textcolor{comment}{/* Debounce was unsuccessful. Return to idle */}
135             butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}} = \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cacc42f7640a397b5daf63328ab9ae0d88}{SD\_BUTTON\_IDLE}};
136         \} \textcolor{keywordflow}{else} \{
137             \textcolor{comment}{/* Check if the timer has expired */}
138             \textcolor{keywordflow}{if} (HAL\_GetTick() > (butt->\mbox{\hyperlink{structsd__button_a260e06ce96c2e4deebccaedeb059dc0b}{tick}} + butt->\mbox{\hyperlink{structsd__button_a3a9f2a46d68b7d2da0fafa3f2ddbdfb1}{down\_to}})) \{
139                 butt->\mbox{\hyperlink{structsd__button_ab831af9861aafa479d1245fb2a3633fc}{down\_cb}}();
140                 butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}} = \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cae5ac55f2e541b7d0295df36ecc6ac09f}{SD\_BUTTON\_DOWN\_DEB}};
141             \}
142         \}
143             
144         \textcolor{keywordflow}{break};
145     
146     \textcolor{keywordflow}{case} \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cae5ac55f2e541b7d0295df36ecc6ac09f}{SD\_BUTTON\_DOWN\_DEB}}:
147         \textcolor{keywordflow}{if} (butt->\mbox{\hyperlink{structsd__button_a82241972e0292c7de95ea1e293e11be3}{port}}->IDR & butt->\mbox{\hyperlink{structsd__button_a4144813adfa4dfe7e7cbeea17d1b06eb}{pin}}) \{
148             \textcolor{comment}{/* The button has been released */}
149             butt->\mbox{\hyperlink{structsd__button_a260e06ce96c2e4deebccaedeb059dc0b}{tick}} = HAL\_GetTick();
150             butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}} = \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303ca69a7dbe193b45ebd832d57ed188fb9d6}{SD\_BUTTON\_UP\_WAIT}};
151         \} \textcolor{keywordflow}{else} \{
152             \textcolor{comment}{/* The button is still pressed */}
153         \}
154         \textcolor{keywordflow}{break};
155     
156     \textcolor{keywordflow}{case} \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303ca69a7dbe193b45ebd832d57ed188fb9d6}{SD\_BUTTON\_UP\_WAIT}}:
157         \textcolor{keywordflow}{if} (butt->\mbox{\hyperlink{structsd__button_a82241972e0292c7de95ea1e293e11be3}{port}}->IDR & butt->\mbox{\hyperlink{structsd__button_a4144813adfa4dfe7e7cbeea17d1b06eb}{pin}}) \{
158             \textcolor{comment}{/* The button detected as released */}
159             \textcolor{keywordflow}{if} (HAL\_GetTick() > (butt->\mbox{\hyperlink{structsd__button_a260e06ce96c2e4deebccaedeb059dc0b}{tick}} + butt->\mbox{\hyperlink{structsd__button_a92e85c4fc2f84cfa9fbed1fd60a7fac7}{up\_to}})) \{
160                 \textcolor{comment}{/* Button debounce successful */}
161                 butt->\mbox{\hyperlink{structsd__button_afc4472a8d74ec3156eae7b77bf8a256c}{up\_cb}}();
162                 butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}} = \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cacc42f7640a397b5daf63328ab9ae0d88}{SD\_BUTTON\_IDLE}};
163             \}
164         \} \textcolor{keywordflow}{else} \{
165             \textcolor{comment}{/* The button was detected as pressed */}
166             butt->\mbox{\hyperlink{structsd__button_ade8bc1d49a12e01bd732b12c411b9861}{state}} = \mbox{\hyperlink{group___s_d___button___types_ggad961a8af755b135c7e69a304d4f6303cae5ac55f2e541b7d0295df36ecc6ac09f}{SD\_BUTTON\_DOWN\_DEB}};
167         \}
168         \textcolor{keywordflow}{break};
169     \}
170     \textcolor{keywordflow}{return} \mbox{\hyperlink{group___s_d___button___types_gga93131f1a3e8fe4f740d62e8ac62685e8a4dfca3cbf0aed46511901c12ac832585}{SD\_BUTTON\_SUCCESS}};
171 \}
\end{DoxyCode}
