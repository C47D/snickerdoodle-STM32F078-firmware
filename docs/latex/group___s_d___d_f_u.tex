\hypertarget{group___s_d___d_f_u}{}\section{Device Firmware Upgrade}
\label{group___s_d___d_f_u}\index{Device Firmware Upgrade@{Device Firmware Upgrade}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{group___s_d___d_f_u_ga405f1d2a69e1cf1f3d1ddbcbc3063651}{sd\+\_\+dfu\+\_\+start}} (void)
\begin{DoxyCompactList}\small\item\em Enter Device Firmware Upgrade Mode Prepare device to enter system memory by disabling peripheral clocks, disable P\+LL, clear pending interrupts and disable interrupts. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Function Documentation}
\mbox{\Hypertarget{group___s_d___d_f_u_ga405f1d2a69e1cf1f3d1ddbcbc3063651}\label{group___s_d___d_f_u_ga405f1d2a69e1cf1f3d1ddbcbc3063651}} 
\index{Device Firmware Upgrade@{Device Firmware Upgrade}!sd\+\_\+dfu\+\_\+start@{sd\+\_\+dfu\+\_\+start}}
\index{sd\+\_\+dfu\+\_\+start@{sd\+\_\+dfu\+\_\+start}!Device Firmware Upgrade@{Device Firmware Upgrade}}
\subsubsection{\texorpdfstring{sd\+\_\+dfu\+\_\+start()}{sd\_dfu\_start()}}
{\footnotesize\ttfamily void sd\+\_\+dfu\+\_\+start (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\mbox{\hyperlink{sd__platform_8c}{Src/sd\+\_\+platform.\+c}}$>$}



Enter Device Firmware Upgrade Mode Prepare device to enter system memory by disabling peripheral clocks, disable P\+LL, clear pending interrupts and disable interrupts. 

Disable peripheral clocks

Disable P\+LL

Disable systick

Run to stack pointer and execute code from system memory
\begin{DoxyCode}
447 \{
448     void (*boot\_jump)(void);
449     
453     \_\_GPIOA\_CLK\_DISABLE();
454     \_\_GPIOB\_CLK\_DISABLE();
455     \_\_GPIOC\_CLK\_DISABLE();
456     \_\_GPIOD\_CLK\_DISABLE();
457     \_\_GPIOE\_CLK\_DISABLE();
458     \_\_GPIOF\_CLK\_DISABLE();
459     
463     RCC->CR    |= (uint32\_t)0x00000001; \textcolor{comment}{/* Set HSION bit */}
464     RCC->CFGR  &= (uint32\_t)0x08FFB80C; \textcolor{comment}{/* Reset SW[1:0], HPRE[3:0], PPRE[2:0], ADCPRE, MCOSEL[2:0],
       MCOPRE[2:0] and PLLNODIV bits */}
465     RCC->CR    &= (uint32\_t)0xFEF6FFFF; \textcolor{comment}{/* Reset HSEON, CSSON and PLLON bits */}
466     RCC->CR    &= (uint32\_t)0xFFFBFFFF; \textcolor{comment}{/* Reset HSEBYP bit */}
467     RCC->CFGR  &= (uint32\_t)0xFFC0FFFF; \textcolor{comment}{/* Reset PLLSRC, PLLXTPRE and PLLMUL[3:0] bits */}
468     RCC->CFGR2 &= (uint32\_t)0xFFFFFFF0; \textcolor{comment}{/* Reset PREDIV1[3:0] bits */}
469     RCC->CFGR3 &= (uint32\_t)0xFFF0FEAC; \textcolor{comment}{/* Reset USARTSW[1:0], I2CSW, CECSW and ADCSW bits */}
470     RCC->CR2   &= (uint32\_t)0xFFFFFFFE; \textcolor{comment}{/* Reset HSI14 bit */}
471     RCC->CIR    = 0x00000000;       \textcolor{comment}{/* Disable all interrupts */}
472     
476     SysTick->CTRL = 0;
477     SysTick->LOAD = 0;
478     SysTick->VAL = 0;
479     
483     \_\_set\_MSP(\mbox{\hyperlink{group___s_d___d_f_u___defines_ga21b3d67021ba56888c69720267842d0b}{BOOT\_STACK\_ADDR}});
484     boot\_jump = (void (*)(void))(*((uint32\_t *)(\mbox{\hyperlink{group___s_d___d_f_u___defines_ga15f619642ddd540adedf01b2c32eb950}{SYS\_MEM\_START\_ADDR}} + 4)));
485     boot\_jump();
486     \textcolor{keywordflow}{while} (1);
487 \}
\end{DoxyCode}
