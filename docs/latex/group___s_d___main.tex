\hypertarget{group___s_d___main}{}\section{Main}
\label{group___s_d___main}\index{Main@{Main}}


Main program entry point and system clock configuration.  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{group___s_d___main_ga70af21c671abfcc773614a9a4f63d920}\label{group___s_d___main_ga70af21c671abfcc773614a9a4f63d920}} 
void \mbox{\hyperlink{group___s_d___main_ga70af21c671abfcc773614a9a4f63d920}{System\+Clock\+\_\+\+Config}} (void)
\begin{DoxyCompactList}\small\item\em System Clock Configuration Configure and initialize the main, systick, timer and peripheral clocks. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group___s_d___main_ga840291bc02cba5474a4cb46a9b9566fe}{main}} (void)
\begin{DoxyCompactList}\small\item\em Main Program Entry Point Initializes each peripheral along with any interrupts and begins execution of the user application. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Main program entry point and system clock configuration. 



\subsection{Function Documentation}
\mbox{\Hypertarget{group___s_d___main_ga840291bc02cba5474a4cb46a9b9566fe}\label{group___s_d___main_ga840291bc02cba5474a4cb46a9b9566fe}} 
\index{Main@{Main}!main@{main}}
\index{main@{main}!Main@{Main}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



{\ttfamily \#include $<$\mbox{\hyperlink{main_8c}{Src/main.\+c}}$>$}



Main Program Entry Point Initializes each peripheral along with any interrupts and begins execution of the user application. 

Reset of all peripherals, Initializes the Flash interface and the Systick timer.

\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000001}{Todo}}]Check the main power supplies here before attempting to boot the Zynq \end{DoxyRefDesc}

\begin{DoxyCode}
95 \{
96     \textcolor{keyword}{enum} \mbox{\hyperlink{group___s_d___platform_ga06667de95c86bfcdef8bcc8ab13cb2d4}{sd\_zynq\_boot}} boot;
97     
102     HAL\_Init();
103 
104     \textcolor{comment}{/* Configure the system clock */}
105     \mbox{\hyperlink{group___s_d___main_ga70af21c671abfcc773614a9a4f63d920}{SystemClock\_Config}}();
106 
107     \textcolor{comment}{/* Initialize the GPIO interface */}
108     \mbox{\hyperlink{group___s_d___g_p_i_o___functions_ga8e151b8cf065d8de5eb8f4908b18072b}{sd\_gpio\_init}}();
109     
110     \textcolor{comment}{/* Set all of the LEDs on */}
111     HAL\_GPIO\_WritePin(RED\_GPIO\_Port, RED\_Pin, GPIO\_PIN\_RESET);
112     HAL\_GPIO\_WritePin(WHITE\_GPIO\_Port, WHITE\_Pin, GPIO\_PIN\_RESET);
113     HAL\_GPIO\_WritePin(GREEN\_GPIO\_Port, GREEN\_Pin, GPIO\_PIN\_RESET);
114     HAL\_GPIO\_WritePin(BLUE\_GPIO\_Port, BLUE\_Pin, GPIO\_PIN\_RESET);
115     HAL\_GPIO\_WritePin(ORANGE\_GPIO\_Port, ORANGE\_Pin, GPIO\_PIN\_RESET);
116     
117     \textcolor{comment}{/* Check the boot configuration */}
118     boot = \mbox{\hyperlink{group___s_d___platform_ga28381c9d642f66d9a6968ff7406a63d4}{sd\_boot\_select}}();
119   
120     \textcolor{comment}{/* Initialize all configured peripherals */}
121     \mbox{\hyperlink{group___s_d___a_d_c___functions_ga1a0d46dabe915346e428a46b9f943879}{sd\_adc\_init}}();
122 
123     \mbox{\hyperlink{group___s_d___i2_c___functions_ga47b7e9401e2826acc6b03f258dc644a9}{sd\_i2c1\_init}}();
124     \mbox{\hyperlink{group___s_d___i2_c___functions_ga8ae735df0c54e25588a526d9a92d3a69}{sd\_i2c2\_init}}();
125 
126     sd\_spi2\_init();
127     
128     \mbox{\hyperlink{group___s_d___p_w_m___functions_ga60aa52b042f8f0dd0af4b31290239242}{sd\_tim1\_init}}();
129     \mbox{\hyperlink{group___s_d___p_w_m___functions_ga0dd6df2aa5533a54908ab2b4035511e1}{sd\_tim3\_init}}();
130     
131     \mbox{\hyperlink{group___s_d___t_i_m___functions_ga795a5beb3ac4ee7060a142b4f1ce4a5d}{sd\_tim7\_init}}();
132     
133     \mbox{\hyperlink{group___s_d___u_a_r_t___functions_ga3c068b8d65ff8482fa0661fc5ef58da0}{sd\_usart1\_init}}();
134     \mbox{\hyperlink{group___s_d___u_a_r_t___functions_gaa39e30aeb0d6ed7754ed9ce3b76d522c}{sd\_usart2\_init}}();
135 
136     \mbox{\hyperlink{group___s_d___platform___boot___config_ga759f86160fc8d270309fc2a74e4139e3}{sd\_zynq\_boot\_config}}(boot);    
137   
138     \textcolor{comment}{/* Initialize the UART buffers */}                     
139     \mbox{\hyperlink{group___s_d___buffer___functions_ga5c105cd566aea7ca95c4b9702b083cc1}{sd\_char\_buff\_init}}(&\mbox{\hyperlink{group___s_d___platform___variables_ga6727cd344d3e2e695b8a5aff466c529b}{uart2\_rx\_cbuff}}, 
      \mbox{\hyperlink{group___s_d___platform___defines_gaf42bf8bfc63a6cca851012eeb8e25b52}{CONS\_UART\_RX\_BUFF\_SIZE}}, \mbox{\hyperlink{group___s_d___platform___variables_ga3c26ef62b04f8b01eb21a42368e16071}{uart2\_rx\_buff}});
140     
141     \textcolor{comment}{/* Set the UART devices with the buffers and prepare to receive */}
142     \mbox{\hyperlink{group___s_d___buffer___functions_ga5c105cd566aea7ca95c4b9702b083cc1}{sd\_char\_buff\_init}}(&\mbox{\hyperlink{group___s_d___platform___variables_gaf4d9d903e4183910ee6764d902948a15}{uart1\_rx\_cbuff}}, 
      \mbox{\hyperlink{group___s_d___platform___defines_gaf42bf8bfc63a6cca851012eeb8e25b52}{CONS\_UART\_RX\_BUFF\_SIZE}}, \mbox{\hyperlink{group___s_d___platform___variables_ga51337e7af0399a1e581d3d5f4f36e339}{uart1\_rx\_buff}});
143     \mbox{\hyperlink{group___s_d___u_a_r_t___functions_ga92a2dfada8629938854ad2fddff0d01d}{sd\_uart\_rx\_init}}(&\mbox{\hyperlink{group___s_d___u_a_r_t___exported___variables_ga34b6075e649bd2f9d6bcef303a9cdce6}{uart1\_dev}}, &\mbox{\hyperlink{group___s_d___platform___variables_gaf4d9d903e4183910ee6764d902948a15}{uart1\_rx\_cbuff}});
144 
145     \textcolor{comment}{/* Initialize the USB device */}
146     MX\_USB\_DEVICE\_Init();
147  
148     \textcolor{comment}{/* Initialize buttons and handlers */}
149     \mbox{\hyperlink{group___s_d___button___functions_gafbd98b246aac98e61d371b0317da9556}{sd\_button\_init}}(&\mbox{\hyperlink{group___s_d___button___variables_ga39ada2536c7b570ccaf03e6847b14490}{reset\_button}},
150             RESET\_BUTTON\_GPIO\_Port,
151             RESET\_BUTTON\_Pin,
152             20,
153             \mbox{\hyperlink{group___s_d___platform___boot___config_gac30b9aa0032a9a8598735242c7cfa5bc}{sd\_zynq\_enable}},
154             2000,
155             \mbox{\hyperlink{group___s_d___platform___boot___config_gaaaa432cbbf3382d321107a38a56b9bef}{sd\_zynq\_disable}});
156             
157     \textcolor{comment}{/* Configure the antenna */}
158     \mbox{\hyperlink{group___s_d___platform___w_l18xx___ant_ga3d09a16b4b68ce526bd3eddba77b655c}{sd\_wl18xx\_ant\_config}}(\mbox{\hyperlink{group___s_d___antenna___select_gad34710c5325cf565b89f2ce2f6fde3ae}{WL18xx\_ANTENNA\_SMA}});
159     
160     \textcolor{comment}{/* Enable wireless clock */}
161     \mbox{\hyperlink{group___s_d___platform___boot___config_ga5f6e21d454cec1f66957897103dafe85}{sd\_wl\_clk\_enable}}(TRUE);
162     
163     \mbox{\hyperlink{group___s_d___platform___boot___config_ga0f06bff92025356b589e3cfdae8ddcb7}{sd\_bt\_enable}}(TRUE);
164     
165     \textcolor{comment}{/* Enable I2C switch */}
166     HAL\_GPIO\_WritePin(SMB\_NRESET\_GPIO\_Port, 
167               SMB\_NRESET\_Pin, GPIO\_PIN\_SET);
168 
169     \textcolor{comment}{/* Start USB, button and LED update timer interrupt */}
170     HAL\_TIM\_Base\_Start\_IT(&\mbox{\hyperlink{group___s_d___t_i_m___exported___variables_gabb71bf3ee68e2a051fbeec6c3ab3012d}{htim7}});
171   
172         \textcolor{comment}{/* Enable Zynq JTAG */}
173     \mbox{\hyperlink{group___s_d___platform___boot___config_ga527ae13356897e13098f309174444556}{sd\_zynq\_jtag\_enable}}(TRUE);
174     
179     
180     \textcolor{comment}{/* Short delay */}
181     HAL\_Delay(20);      
182     
183     \textcolor{comment}{/* Enable Zynq power */}
184     \mbox{\hyperlink{group___s_d___platform___boot___config_gac30b9aa0032a9a8598735242c7cfa5bc}{sd\_zynq\_enable}}();
185     
186     \textcolor{comment}{/* Poll until power good signal is asserted */}
187     \textcolor{keywordflow}{while} (HAL\_GPIO\_ReadPin(ZYNQ\_POWER\_GOOD\_GPIO\_Port,
188                 ZYNQ\_POWER\_GOOD\_Pin) != GPIO\_PIN\_SET)
189         HAL\_Delay(10);
190 
191     \textcolor{comment}{/* Enable Zynq clock */}
192     \mbox{\hyperlink{group___s_d___platform___boot___config_gad7a6663ba74657a3939e7a9701db0454}{sd\_zynq\_clk\_enable}}(TRUE);
193 
194     \textcolor{comment}{/* Infinite loop */}
195     \textcolor{keywordflow}{while} (1) \{
196         HAL\_Delay(250);
197     \}
198 \}
\end{DoxyCode}
