\hypertarget{sd__platform_8c}{}\section{Src/sd\+\_\+platform.c File Reference}
\label{sd__platform_8c}\index{Src/sd\+\_\+platform.\+c@{Src/sd\+\_\+platform.\+c}}


Platform Controller Functions.  


{\ttfamily \#include \char`\"{}stm32f0xx\+\_\+hal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+tim.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}usb\+\_\+device.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+gpio.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}usbd\+\_\+cdc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+usbd\+\_\+cdc\+\_\+if.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+buffer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+uart.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+i2c.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+spi.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+led.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+led\+\_\+pattern.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+button.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sd\+\_\+platform.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group___s_d___platform_ga086665d90c28883d36a12fa61ad26eaf}{S\+D\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+N\+O\+R\+M\+A\+L\+\_\+\+B\+O\+OT}}~0x00
\item 
\#define \mbox{\hyperlink{group___s_d___platform_gaed22fc6c832ec83bcc4aa35bace12970}{S\+D\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+D\+F\+U\+\_\+\+B\+O\+OT}}~0x03
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_gad7a6663ba74657a3939e7a9701db0454}{sd\+\_\+zynq\+\_\+clk\+\_\+enable}} (uint8\+\_\+t enable)
\begin{DoxyCompactList}\small\item\em Zynq Clock Enable Enables the main clock source for the Zynq A\+PU. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_ga527ae13356897e13098f309174444556}{sd\+\_\+zynq\+\_\+jtag\+\_\+enable}} (uint8\+\_\+t enable)
\begin{DoxyCompactList}\small\item\em Zynq J\+T\+AG Enable Enables the J\+T\+AG interface for programming the PS or PL. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_ga5f6e21d454cec1f66957897103dafe85}{sd\+\_\+wl\+\_\+clk\+\_\+enable}} (uint8\+\_\+t enable)
\begin{DoxyCompactList}\small\item\em Wireless Clock Enable Enable the wireless module 32k\+Hz clock source. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_ga0f06bff92025356b589e3cfdae8ddcb7}{sd\+\_\+bt\+\_\+enable}} (uint8\+\_\+t enable)
\begin{DoxyCompactList}\small\item\em Bluetooth Enable Enable the Bluetooth interface on the wireless module. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_ga759f86160fc8d270309fc2a74e4139e3}{sd\+\_\+zynq\+\_\+boot\+\_\+config}} (enum \mbox{\hyperlink{group___s_d___platform_ga06667de95c86bfcdef8bcc8ab13cb2d4}{sd\+\_\+zynq\+\_\+boot}} boot)
\begin{DoxyCompactList}\small\item\em Zynq Boot Config Outputs boot select pins to zynq for desired boot media source. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_ga65b13e7293170788758e4f8cd8512326}{sd\+\_\+zynq\+\_\+reset}} (void)
\begin{DoxyCompactList}\small\item\em Zynq Reset Reset the Zynq A\+PU. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_gaaaa432cbbf3382d321107a38a56b9bef}{sd\+\_\+zynq\+\_\+disable}} (void)
\begin{DoxyCompactList}\small\item\em Disable Zynq Power Disable the Zynq power rails by setting the enable pin low. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___platform___boot___config_gac30b9aa0032a9a8598735242c7cfa5bc}{sd\+\_\+zynq\+\_\+enable}} (void)
\begin{DoxyCompactList}\small\item\em Enable Zynq Power Enable the Zynq power rails by setting the enable pin high. \end{DoxyCompactList}\item 
void {\bfseries H\+A\+L\+\_\+\+G\+P\+I\+O\+\_\+\+E\+X\+T\+I\+\_\+\+Callback} (uint16\+\_\+t pin)
\item 
void \mbox{\hyperlink{group___s_d___platform___w_l18xx___ant_ga3d09a16b4b68ce526bd3eddba77b655c}{sd\+\_\+wl18xx\+\_\+ant\+\_\+config}} (uint8\+\_\+t ant)
\begin{DoxyCompactList}\small\item\em W\+L18xx Antenna Configuration Outputs antenna select pins for the wireless module. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{group___s_d___u_a_r_t___u_s_b___bridge___types_ga7e4773a8cce69fafe541cad55985f146}{sd\+\_\+uart\+\_\+usb\+\_\+err}} \mbox{\hyperlink{group___s_d___u_a_r_t___u_s_b___bridge_gaa03f4625c66a0fe3be62a6aead8ac2ba}{sd\+\_\+uart\+\_\+usb\+\_\+bridge\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em U\+A\+RT to U\+SB Bridge Initialization Initialize U\+A\+RT device structure, U\+A\+RT to U\+SB bridge buffer and set the U\+A\+RT device to use the (previously initialized) U\+A\+RT peripheral and newly initialized buffer. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{group___s_d___u_a_r_t___u_s_b___bridge___types_ga7e4773a8cce69fafe541cad55985f146}{sd\+\_\+uart\+\_\+usb\+\_\+err}} \mbox{\hyperlink{group___s_d___u_a_r_t___u_s_b___bridge_ga7277fee3051720471dd68980c4928cbc}{sd\+\_\+uart\+\_\+usb\+\_\+transmit}} (struct \mbox{\hyperlink{structsd__uart__dev}{sd\+\_\+uart\+\_\+dev}} $\ast$dev)
\begin{DoxyCompactList}\small\item\em U\+A\+RT to U\+SB Bridge Transmission Transmit the buffer that has been recieved on the bridged U\+A\+RT over U\+SB communications device. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___s_d___d_f_u_ga405f1d2a69e1cf1f3d1ddbcbc3063651}{sd\+\_\+dfu\+\_\+start}} (void)
\begin{DoxyCompactList}\small\item\em Enter Device Firmware Upgrade Mode Prepare device to enter system memory by disabling peripheral clocks, disable P\+LL, clear pending interrupts and disable interrupts. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{group___s_d___platform_ga0cfdf02c4e2dcebe57216fb62c79d464}{sd\+\_\+boot\+\_\+button}} \mbox{\hyperlink{group___s_d___platform_ga0d7f90ea76b8ffd5d714122177f84b3b}{sd\+\_\+boot\+\_\+get\+\_\+button\+\_\+state}} (void)
\begin{DoxyCompactList}\small\item\em Get button press state. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{group___s_d___platform_ga12d2befc51ccaa811a666d7eca5761ff}{sd\+\_\+boot\+\_\+timer\+\_\+expired}} (uint32\+\_\+t start, uint32\+\_\+t end)
\begin{DoxyCompactList}\small\item\em Check if boot timer has expired. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{group___s_d___platform_ga06667de95c86bfcdef8bcc8ab13cb2d4}{sd\+\_\+zynq\+\_\+boot}} \mbox{\hyperlink{group___s_d___platform_ga28381c9d642f66d9a6968ff7406a63d4}{sd\+\_\+boot\+\_\+select}} (void)
\begin{DoxyCompactList}\small\item\em Boot selection. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsd__cbuf}{sd\+\_\+cbuf}} \mbox{\hyperlink{group___s_d___platform___variables_gaf4d9d903e4183910ee6764d902948a15}{uart1\+\_\+rx\+\_\+cbuff}}
\item 
struct \mbox{\hyperlink{structsd__cbuf}{sd\+\_\+cbuf}} \mbox{\hyperlink{group___s_d___platform___variables_ga6727cd344d3e2e695b8a5aff466c529b}{uart2\+\_\+rx\+\_\+cbuff}}
\item 
struct \mbox{\hyperlink{structsd__doub__buff}{sd\+\_\+doub\+\_\+buff}} \mbox{\hyperlink{group___s_d___platform___variables_gab1427a377589df62b3cedc5dae7d1d7a}{cons\+\_\+dbuff}}
\item 
uint8\+\_\+t \mbox{\hyperlink{group___s_d___platform___variables_ga51337e7af0399a1e581d3d5f4f36e339}{uart1\+\_\+rx\+\_\+buff}} \mbox{[}\mbox{\hyperlink{group___s_d___platform___defines_gaf42bf8bfc63a6cca851012eeb8e25b52}{C\+O\+N\+S\+\_\+\+U\+A\+R\+T\+\_\+\+R\+X\+\_\+\+B\+U\+F\+F\+\_\+\+S\+I\+ZE}}\mbox{]}
\item 
uint8\+\_\+t \mbox{\hyperlink{group___s_d___platform___variables_ga3c26ef62b04f8b01eb21a42368e16071}{uart2\+\_\+rx\+\_\+buff}} \mbox{[}\mbox{\hyperlink{group___s_d___platform___defines_gaf42bf8bfc63a6cca851012eeb8e25b52}{C\+O\+N\+S\+\_\+\+U\+A\+R\+T\+\_\+\+R\+X\+\_\+\+B\+U\+F\+F\+\_\+\+S\+I\+ZE}}\mbox{]}
\item 
uint8\+\_\+t \mbox{\hyperlink{group___s_d___platform___variables_ga3806775e16d4988e597b07388bf0c26d}{cons\+\_\+buff}} \mbox{[}2\mbox{]}\mbox{[}\mbox{\hyperlink{group___s_d___platform___defines_gaf42bf8bfc63a6cca851012eeb8e25b52}{C\+O\+N\+S\+\_\+\+U\+A\+R\+T\+\_\+\+R\+X\+\_\+\+B\+U\+F\+F\+\_\+\+S\+I\+ZE}}\mbox{]}
\item 
uint8\+\_\+t \mbox{\hyperlink{group___s_d___platform___variables_gab7c02f3f6c00933734e1e19e7d2f99d8}{hci\+\_\+params\+\_\+buff}} \mbox{[}\mbox{\hyperlink{group___s_d___platform___defines_gaf42bf8bfc63a6cca851012eeb8e25b52}{C\+O\+N\+S\+\_\+\+U\+A\+R\+T\+\_\+\+R\+X\+\_\+\+B\+U\+F\+F\+\_\+\+S\+I\+ZE}}\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Platform Controller Functions. 

\begin{DoxyAuthor}{Author}
R. Bush  \href{mailto:bush@krtkl.com}{\tt bush@krtkl.\+com} 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
v1.\+0 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2016 March 28 
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Free\+B\+SD
\end{DoxyCopyright}
Copyright (c) 2016, krtkl inc. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met\+:


\begin{DoxyEnumerate}
\item Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
\item Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
\end{DoxyEnumerate}

T\+H\+IS S\+O\+F\+T\+W\+A\+RE IS P\+R\+O\+V\+I\+D\+ED BY T\+HE C\+O\+P\+Y\+R\+I\+G\+HT H\+O\+L\+D\+E\+RS A\+ND C\+O\+N\+T\+R\+I\+B\+U\+T\+O\+RS \char`\"{}\+A\+S I\+S\char`\"{} A\+ND A\+NY E\+X\+P\+R\+E\+SS OR I\+M\+P\+L\+I\+ED W\+A\+R\+R\+A\+N\+T\+I\+ES, I\+N\+C\+L\+U\+D\+I\+NG, B\+UT N\+OT L\+I\+M\+I\+T\+ED TO, T\+HE I\+M\+P\+L\+I\+ED W\+A\+R\+R\+A\+N\+T\+I\+ES OF M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY A\+ND F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE A\+RE D\+I\+S\+C\+L\+A\+I\+M\+ED. IN NO E\+V\+E\+NT S\+H\+A\+LL T\+HE C\+O\+P\+Y\+R\+I\+G\+HT O\+W\+N\+ER OR C\+O\+N\+T\+R\+I\+B\+U\+T\+O\+RS BE L\+I\+A\+B\+LE F\+OR A\+NY D\+I\+R\+E\+CT, I\+N\+D\+I\+R\+E\+CT, I\+N\+C\+I\+D\+E\+N\+T\+AL, S\+P\+E\+C\+I\+AL, E\+X\+E\+M\+P\+L\+A\+RY, OR C\+O\+N\+S\+E\+Q\+U\+E\+N\+T\+I\+AL D\+A\+M\+A\+G\+ES (I\+N\+C\+L\+U\+D\+I\+NG, B\+UT N\+OT L\+I\+M\+I\+T\+ED TO, P\+R\+O\+C\+U\+R\+E\+M\+E\+NT OF S\+U\+B\+S\+T\+I\+T\+U\+TE G\+O\+O\+DS OR S\+E\+R\+V\+I\+C\+ES; L\+O\+SS OF U\+SE, D\+A\+TA, OR P\+R\+O\+F\+I\+TS; OR B\+U\+S\+I\+N\+E\+SS I\+N\+T\+E\+R\+R\+U\+P\+T\+I\+ON) H\+O\+W\+E\+V\+ER C\+A\+U\+S\+ED A\+ND ON A\+NY T\+H\+E\+O\+RY OF L\+I\+A\+B\+I\+L\+I\+TY, W\+H\+E\+T\+H\+ER IN C\+O\+N\+T\+R\+A\+CT, S\+T\+R\+I\+CT L\+I\+A\+B\+I\+L\+I\+TY, OR T\+O\+RT (I\+N\+C\+L\+U\+D\+I\+NG N\+E\+G\+L\+I\+G\+E\+N\+CE OR O\+T\+H\+E\+R\+W\+I\+SE) A\+R\+I\+S\+I\+NG IN A\+NY W\+AY O\+UT OF T\+HE U\+SE OF T\+H\+IS S\+O\+F\+T\+W\+A\+RE, E\+V\+EN IF A\+D\+V\+I\+S\+ED OF T\+HE P\+O\+S\+S\+I\+B\+I\+L\+I\+TY OF S\+U\+CH D\+A\+M\+A\+GE.

The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official policies, either expressed or implied, of the Free\+B\+SD Project. 